---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 1"
author: "Sophie Boyd"
date: "2-6-26"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

```{r dennys-dimensions}
view(dennys)
nrow(dennys)
ncol(dennys)
```

The Denny's dataset contains 1643 observations of 6 variables. Each row represents one Denny's establishment. The variables are address, city, state, zip code, longitude, and latitude.

### Exercise 2

```{r laquinta-dimensions}
view(laquinta)
nrow(laquinta)
ncol(laquinta)
```

The La Quinta dataset contains 909 observations of 6 variables. Each row represents one La Quinta establishment. The variables are the same as the Denny's dataset: address, city, state, zip code, longitude, and latitude.

### Exercise 3

The La Quinta website lists many locations outside of the US, including in Canada, Mexico, China, New Zealand, Georgia, Turkiye, the UAE, Colombia, and Ecuador.

The Denny's website seems to only contain locations in the US.

### Exercise 4

One way to determine if locations in either dataset are outside of the US would be to look at the values on the "state" variable. If the values do not indicate a US state, this would confirm that the establishment is located outside of the US. 

### Exercise 5

```{r dennys-US}
dennys %>%
  filter(!(state %in% states$abbreviation))
```

There do not appear to be any Denny's locations outside of the US.

### Exercise 6

```{r dennys-country}
dennys <- dennys %>%
  mutate(country = "United States")
```

### Exercise 7
 
```{r laquinta-country}
laquinta %>%
  filter(!(state %in% states$abbreviation))
```

The La Quinta locations outside of the US are in:
1. Mexico
2. Mexico
3. Mexico
4. Mexico
5. Colombia
6. Mexico
7. Mexico
8. Canada
9. Mexico
10. Mexico
11. Mexico
12. Mexico
13. Honduras
14. Canada

### Exercise 8

```{r laquinta-country-variable}
laquinta <- laquinta %>%
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state %in% c("AG", "QR", "CH", "NL", "VE", "PU", "SL") ~ "Mexico",
    state == "FM" ~ "Honduras"
  ))
```

```{r laquinta-US}
laquinta <- laquinta %>%
  filter(country == "United States")
```

### Exercise 9

```{r dennys-state}
dennys %>%
  count(state, sort = TRUE)
```

```{r laquinta-state}
laquinta %>%
  count(state, sort = TRUE)
```

Denny's has the most locations in California and the fewest locations in Delaware. La Quinta has the most locations in Texas and the fewest locations in Maine. These results do not surprise me, considering that California and Texas are both very large states and Maine and Delaware (especially Delaware) are much smaller. 

```{r states-n}
dennys %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

### Exercise 10

```{r establishment}
dennys <- dennys %>%
  mutate(establishment = "Denny's")
laquinta <- laquinta %>%
  mutate(establishment = "La Quinta")
```

```{r bind}
dn_lq <- bind_rows(dennys, laquinta)
```

```{r US-plot}
ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point()
```

### Exercise 11

```{r NC-filter}
dn_lq_NC <- dn_lq %>%
  filter(state == "NC")
```

```{r NC-plot}
ggplot(dn_lq_NC, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point(alpha = .6) +
  labs(x = "Longitude",
       y = "Latitude",
       title = "Denny's & La Quinta Locations in NC",
       color = "Establishment")
```

Mitch Hedberg's joke seems to be somewhat supported in the North Carolina plot. With some exceptions, most of the La Quinta establishments are located relatively close to one or more Denny's establishments. 

### Exercise 12

```{r TX-filter}
dn_lq_TX <- dn_lq %>%
  filter(state == "TX")
```

```{r TX-plot}
ggplot(dn_lq_TX, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point(alpha = .6) +
  labs(x = "Longitude",
       y = "Latitude",
       title = "Denny's & La Quinta Locations in TX",
       color = "Establishment")
```

While there are clusters of many La Quinta and Denny's establishments located close together, overall, the joke does not hold up on the Texas map because there are many La Quinta locations with no Denny's locations nearby.
